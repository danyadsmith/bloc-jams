var currentAlbum=null,currentlyPlayingSongNumber=null,currentSongFromAlbum=null,currentSongFile=null,currentVolume=80,$previousButton=$(".main-controls .previous"),$nextButton=$(".main-controls .next"),$playPauseToggle=$(".main-controls .play-pause"),$volumeBar=$(".volume .fill"),$volumeSlider=$(".volume .thumb"),$currentTimeContainer=$(".current-time"),$totalTimeContainer=$(".total-time"),albumList=[albumPicasso,albumMarconi,albumPurpleRain],counter=0,playButtonTemplate="<a class='album-song-button'><span class='ion-play'></span></a>",pauseButtonTemplate="<a class='album-song-button'><span class='ion-pause'></span></a>",playerBarPlayButton="<span class='ion-play'></span>",playerBarPauseButton="<span class='ion-pause'></span>",createSongRow=function(e,t,n){var r="<tr class='album-view-song-item'>  <td class='song-item-number' data-song-number='"+e+"'>"+e+"</td>  <td class='song-item-title'>"+t+"</td>  <td class='song-item-duration'>"+filterTimeCode(n)+"</td></tr>",u=$(r),a=function(){var e=$(this).attr("data-song-number");if(null!==currentlyPlayingSongNumber){var t=getSongNumberContainer(currentlyPlayingSongNumber);t.html(currentlyPlayingSongNumber)}currentlyPlayingSongNumber!==e?($(this).html(pauseButtonTemplate),setSong(e),updatePlayerBarSong(),currentSongFile.play(),updateSeekBarWhileSongPlays(),$volumeBar.width(currentVolume+"%"),$volumeSlider.css("left",currentVolume+"%")):currentlyPlayingSongNumber===e&&(currentSongFile.isPaused()?($(this).html(pauseButtonTemplate),$playPauseToggle.html(playerBarPauseButton),currentSongFile.play(),updateSeekBarWhileSongPlays()):($(this).html(playButtonTemplate),$playPauseToggle.html(playerBarPlayButton),currentSongFile.pause()))},l=function(e){var t=$(this).find(".song-item-number"),n=t.attr("data-song-number");n!==currentlyPlayingSongNumber&&t.html(playButtonTemplate)},o=function(e){var t=$(this).find(".song-item-number"),n=t.attr("data-song-number");n!==currentlyPlayingSongNumber&&t.html(n)};return u.find(".song-item-number").click(a),u.hover(l,o),u},filterTimeCode=function(e){var t=parseFloat(e)/60,n=Math.floor(t),r=Math.floor(100*(t-n));return r<10?n+":0"+r:n+":"+r},getSongNumberContainer=function(e){return $(".song-item-number[data-song-number='"+e+"']")},nextSong=function(){var e=function(e){return 0===e?currentAlbum.songs.length:e},t=trackIndex(currentAlbum,currentSongFromAlbum);t++,t>=currentAlbum.songs.length&&(t=0),setSong(t+1),currentSongFile.play(),updatePlayerBarSong(),updateSeekBarWhileSongPlays();var n=e(t),r=getSongNumberContainer(currentlyPlayingSongNumber),u=getSongNumberContainer(n);r.html(pauseButtonTemplate),u.html(n)},previousSong=function(){var e=function(e){return e==currentAlbum.songs.length-1?1:e+2},t=trackIndex(currentAlbum,currentSongFromAlbum);t--,t<0&&(t=currentAlbum.songs.length-1),setSong(t+1),currentSongFile.play(),updatePlayerBarSong(),updateSeekBarWhileSongPlays();var n=e(t),r=getSongNumberContainer(currentlyPlayingSongNumber),u=getSongNumberContainer(n);r.html(pauseButtonTemplate),u.html(n)},seek=function(e){currentSongFile&&currentSongFile.setTime(e)},setCurrentAlbum=function(e){currentAlbum=e;var t=$(".album-view-title"),n=$(".album-view-artist"),r=$(".album-view-release-info"),u=$(".album-cover-art"),a=$(".album-view-song-list");t.text(e.title),n.text(e.artist),r.text(e.year+" "+e.label),u.attr("src",e.albumArtUrl),a.empty();for(var l=0;l<e.songs.length;l++){var o=createSongRow(l+1,e.songs[l].title,e.songs[l].duration);a.append(o)}},setCurrentTimeInPlayerBar=function(e){$currentTimeContainer.html(filterTimeCode(e))},setSong=function(e){currentSongFile&&currentSongFile.stop(),currentlyPlayingSongNumber=e,currentSongFromAlbum=currentAlbum.songs[e-1],currentSongFile=new buzz.sound(currentSongFromAlbum.audioUrl,{formats:["mp3"],preload:!0}),setVolume(currentVolume),$(".currently-playing .song-name").text(currentSongFromAlbum.title),$(".currently-playing .artist-name").text(currentSongFromAlbum.artist),$(".currently-playing .artist-song-mobile").text(currentSongFromAlbum.title+" - "+currentAlbum.title),$playPauseToggle.html(playerBarPauseButton)},setTotalTimeInPlayerBar=function(e){$totalTimeContainer.html(filterTimeCode(e))},setVolume=function(e){currentSongFile&&currentSongFile.setVolume(e)},setupSeekBars=function(){var e=$(".player-bar .seek-bar");e.click(function(e){var t=e.pageX-$(this).offset().left,n=$(this).width(),r=t/n;$(this).parent().hasClass("volume")?setVolume(100*r):seek(r*currentSongFile.getDuration()),updateSeekPercentage($(this),r)}),e.find(".thumb").mousedown(function(e){var t=$(this).parent();$(document).bind("mousemove.thumb",function(e){var n=e.pageX-t.offset().left,r=t.width(),u=n/r;$(this).parent().hasClass("volume")?setVolume(u):seek(u*currentSongFile.getDuration()),updateSeekPercentage(t,u)}),$(document).bind("mouseup.thumb",function(){$(document).unbind("mousemove.thumb"),$(document).unbind("mouseup.thumb")})})},togglePlayFromPlayerBar=function(){currentSongFile.isPaused()?($playPauseToggle.html(playerBarPauseButton),getSongNumberContainer(currentlyPlayingSongNumber).html(pauseButtonTemplate),currentSongFile.play()):($playPauseToggle.html(playerBarPlayButton),getSongNumberContainer(currentlyPlayingSongNumber).html(currentlyPlayingSongNumber),currentSongFile.pause())},trackIndex=function(e,t){return e.songs.indexOf(t)},updatePlayerBarSong=function(){$playPauseToggle.html(playerBarPauseButton)},updateSeekBarWhileSongPlays=function(){currentSongFile&&currentSongFile.bind("timeupdate",function(e){var t=this.getTime()/this.getDuration(),n=$(".seek-control .seek-bar");updateSeekPercentage(n,t),setCurrentTimeInPlayerBar(this.getTime()),setTotalTimeInPlayerBar(this.getDuration())})},updateSeekPercentage=function(e,t){var n=100*t;n=Math.max(0,n),n=Math.min(100,n);var r=n+"%";e.find(".fill").width(r),e.find(".thumb").css({left:r})};$(document).ready(function(){setCurrentAlbum(albumPicasso),setupSeekBars(),$previousButton.click(previousSong),$nextButton.click(nextSong),$playPauseToggle.click(togglePlayFromPlayerBar);document.getElementById("album-cover")});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsYnVtLmpzIl0sIm5hbWVzIjpbImN1cnJlbnRBbGJ1bSIsImN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyIiwiY3VycmVudFNvbmdGcm9tQWxidW0iLCJjdXJyZW50U29uZ0ZpbGUiLCJjdXJyZW50Vm9sdW1lIiwiJHByZXZpb3VzQnV0dG9uIiwiJCIsIiRuZXh0QnV0dG9uIiwiJHBsYXlQYXVzZVRvZ2dsZSIsIiR2b2x1bWVCYXIiLCIkdm9sdW1lU2xpZGVyIiwiJGN1cnJlbnRUaW1lQ29udGFpbmVyIiwiJHRvdGFsVGltZUNvbnRhaW5lciIsImFsYnVtTGlzdCIsImFsYnVtUGljYXNzbyIsImFsYnVtTWFyY29uaSIsImFsYnVtUHVycGxlUmFpbiIsImNvdW50ZXIiLCJwbGF5QnV0dG9uVGVtcGxhdGUiLCJwYXVzZUJ1dHRvblRlbXBsYXRlIiwicGxheWVyQmFyUGxheUJ1dHRvbiIsInBsYXllckJhclBhdXNlQnV0dG9uIiwiY3JlYXRlU29uZ1JvdyIsInNvbmdOdW1iZXIiLCJzb25nTmFtZSIsInNvbmdMZW5ndGgiLCJ0ZW1wbGF0ZSIsImZpbHRlclRpbWVDb2RlIiwiJHJvdyIsImNsaWNrSGFuZGxlciIsInRoaXMiLCJhdHRyIiwiY3VycmVudGx5UGxheWluZ0NvbnRhaW5lciIsImdldFNvbmdOdW1iZXJDb250YWluZXIiLCJodG1sIiwic2V0U29uZyIsInVwZGF0ZVBsYXllckJhclNvbmciLCJwbGF5IiwidXBkYXRlU2Vla0JhcldoaWxlU29uZ1BsYXlzIiwid2lkdGgiLCJjc3MiLCJpc1BhdXNlZCIsInBhdXNlIiwib25Ib3ZlciIsImV2ZW50Iiwic29uZ051bWJlckNvbnRhaW5lciIsImZpbmQiLCJvZmZIb3ZlciIsImNsaWNrIiwiaG92ZXIiLCJ0aW1lSW5TZWNvbmRzIiwidGltZUluTWludXRlcyIsInBhcnNlRmxvYXQiLCJtaW51dGVzIiwiTWF0aCIsImZsb29yIiwic2Vjb25kcyIsIm51bWJlciIsIm5leHRTb25nIiwiZ2V0TGFzdFNvbmdOdW1iZXIiLCJpbmRleCIsInNvbmdzIiwibGVuZ3RoIiwiY3VycmVudFNvbmdJbmRleCIsInRyYWNrSW5kZXgiLCJsYXN0U29uZ051bWJlciIsIiRuZXh0U29uZ051bWJlckNlbGwiLCIkbGFzdFNvbmdOdW1iZXJDZWxsIiwicHJldmlvdXNTb25nIiwiJHByZXZpb3VzU29uZ051bWJlckNlbGwiLCJzZWVrIiwidGltZSIsInNldFRpbWUiLCJzZXRDdXJyZW50QWxidW0iLCJhbGJ1bSIsIiRhbGJ1bVRpdGxlIiwiJGFsYnVtQXJ0aXN0IiwiJGFsYnVtUmVsZWFzZUluZm8iLCIkYWxidW1JbWFnZSIsIiRhbGJ1bVNvbmdMaXN0IiwidGV4dCIsInRpdGxlIiwiYXJ0aXN0IiwieWVhciIsImxhYmVsIiwiYWxidW1BcnRVcmwiLCJlbXB0eSIsImkiLCIkbmV3Um93IiwiZHVyYXRpb24iLCJhcHBlbmQiLCJzZXRDdXJyZW50VGltZUluUGxheWVyQmFyIiwiY3VycmVudFRpbWUiLCJzdG9wIiwiYnV6eiIsInNvdW5kIiwiYXVkaW9VcmwiLCJmb3JtYXRzIiwicHJlbG9hZCIsInNldFZvbHVtZSIsInNldFRvdGFsVGltZUluUGxheWVyQmFyIiwidG90YWxUaW1lIiwidm9sdW1lIiwic2V0dXBTZWVrQmFycyIsIiRzZWVrQmFycyIsIm9mZnNldFgiLCJwYWdlWCIsIm9mZnNldCIsImxlZnQiLCJiYXJXaWR0aCIsInNlZWtCYXJGaWxsUmF0aW8iLCJwYXJlbnQiLCJoYXNDbGFzcyIsImdldER1cmF0aW9uIiwidXBkYXRlU2Vla1BlcmNlbnRhZ2UiLCJtb3VzZWRvd24iLCIkY3VycmVudFNlZWtCYXIiLCJkb2N1bWVudCIsImJpbmQiLCJ1bmJpbmQiLCJ0b2dnbGVQbGF5RnJvbVBsYXllckJhciIsInNvbmciLCJpbmRleE9mIiwiZ2V0VGltZSIsIiRzZWVrQmFyIiwib2Zmc2V0WFBlcmNlbnQiLCJtYXgiLCJtaW4iLCJwZXJjZW50YWdlU3RyaW5nIiwicmVhZHkiLCJnZXRFbGVtZW50QnlJZCJdLCJtYXBwaW5ncyI6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LFVBQ2xCbEQsaUJBQWlCd0MsTUFBTXdFLHdCQUNOSCxVQUFTYSxlQUFlIiwiZmlsZSI6ImFsYnVtLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypnbG9iYWwgJCBhbGJ1bVBpY2Fzc28gYWxidW1NYXJjb25pIGFsYnVtUHVycGxlUmFpbiA6dHJ1ZSovXG5cbnZhciBjdXJyZW50QWxidW0gPSBudWxsO1xudmFyIGN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyID0gbnVsbDtcbnZhciBjdXJyZW50U29uZ0Zyb21BbGJ1bSA9IG51bGw7XG52YXIgY3VycmVudFNvbmdGaWxlID0gbnVsbDtcbnZhciBjdXJyZW50Vm9sdW1lID0gODA7XG5cbnZhciAkcHJldmlvdXNCdXR0b24gPSAkKFwiLm1haW4tY29udHJvbHMgLnByZXZpb3VzXCIpO1xudmFyICRuZXh0QnV0dG9uID0gJChcIi5tYWluLWNvbnRyb2xzIC5uZXh0XCIpO1xudmFyICRwbGF5UGF1c2VUb2dnbGUgPSAkKFwiLm1haW4tY29udHJvbHMgLnBsYXktcGF1c2VcIik7XG52YXIgJHZvbHVtZUJhciA9ICQoXCIudm9sdW1lIC5maWxsXCIpO1xudmFyICR2b2x1bWVTbGlkZXIgPSAkKFwiLnZvbHVtZSAudGh1bWJcIik7XG52YXIgJGN1cnJlbnRUaW1lQ29udGFpbmVyID0gJChcIi5jdXJyZW50LXRpbWVcIik7XG52YXIgJHRvdGFsVGltZUNvbnRhaW5lciA9ICQoXCIudG90YWwtdGltZVwiKTtcblxudmFyIGFsYnVtTGlzdCA9IFthbGJ1bVBpY2Fzc28sIGFsYnVtTWFyY29uaSwgYWxidW1QdXJwbGVSYWluXTtcbnZhciBjb3VudGVyID0gMDtcbnZhciBwbGF5QnV0dG9uVGVtcGxhdGUgPSBcIjxhIGNsYXNzPSdhbGJ1bS1zb25nLWJ1dHRvbic+PHNwYW4gY2xhc3M9J2lvbi1wbGF5Jz48L3NwYW4+PC9hPlwiO1xudmFyIHBhdXNlQnV0dG9uVGVtcGxhdGUgPSBcIjxhIGNsYXNzPSdhbGJ1bS1zb25nLWJ1dHRvbic+PHNwYW4gY2xhc3M9J2lvbi1wYXVzZSc+PC9zcGFuPjwvYT5cIjtcbnZhciBwbGF5ZXJCYXJQbGF5QnV0dG9uID0gXCI8c3BhbiBjbGFzcz0naW9uLXBsYXknPjwvc3Bhbj5cIjtcbnZhciBwbGF5ZXJCYXJQYXVzZUJ1dHRvbiA9IFwiPHNwYW4gY2xhc3M9J2lvbi1wYXVzZSc+PC9zcGFuPlwiO1xuXG5cbnZhciBjcmVhdGVTb25nUm93ID0gZnVuY3Rpb24oc29uZ051bWJlciwgc29uZ05hbWUsIHNvbmdMZW5ndGgpe1xuICB2YXIgdGVtcGxhdGUgPSBcbiAgICAgIFwiPHRyIGNsYXNzPSdhbGJ1bS12aWV3LXNvbmctaXRlbSc+XCIgKyBcbiAgICAgIFwiICA8dGQgY2xhc3M9J3NvbmctaXRlbS1udW1iZXInIGRhdGEtc29uZy1udW1iZXI9J1wiICsgc29uZ051bWJlciArIFwiJz5cIiArIHNvbmdOdW1iZXIgKyBcIjwvdGQ+XCIgKyBcbiAgICAgIFwiICA8dGQgY2xhc3M9J3NvbmctaXRlbS10aXRsZSc+XCIgKyBzb25nTmFtZSArIFwiPC90ZD5cIiArIFxuICAgICAgXCIgIDx0ZCBjbGFzcz0nc29uZy1pdGVtLWR1cmF0aW9uJz5cIiArIGZpbHRlclRpbWVDb2RlKHNvbmdMZW5ndGgpICsgXCI8L3RkPlwiICsgXG4gICAgICBcIjwvdHI+XCI7XG5cbiAgdmFyICRyb3cgPSAkKHRlbXBsYXRlKTtcblxuICB2YXIgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc29uZ051bWJlciA9ICQodGhpcykuYXR0cihcImRhdGEtc29uZy1udW1iZXJcIik7XG5cbiAgICBpZihjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlciAhPT0gbnVsbCl7XG4gICAgICB2YXIgY3VycmVudGx5UGxheWluZ0NvbnRhaW5lciA9IGdldFNvbmdOdW1iZXJDb250YWluZXIoY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIpO1xuICAgICAgY3VycmVudGx5UGxheWluZ0NvbnRhaW5lci5odG1sKGN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyKTtcbiAgICB9XG4gICAgaWYoY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIgIT09IHNvbmdOdW1iZXIpe1xuICAgICAgJCh0aGlzKS5odG1sKHBhdXNlQnV0dG9uVGVtcGxhdGUpO1xuICAgICAgc2V0U29uZyhzb25nTnVtYmVyKTtcbiAgICAgIHVwZGF0ZVBsYXllckJhclNvbmcoKTtcbiAgICAgIGN1cnJlbnRTb25nRmlsZS5wbGF5KCk7XG4gICAgICB1cGRhdGVTZWVrQmFyV2hpbGVTb25nUGxheXMoKTtcbiAgICAgICR2b2x1bWVCYXIud2lkdGgoY3VycmVudFZvbHVtZSArIFwiJVwiKTtcbiAgICAgICR2b2x1bWVTbGlkZXIuY3NzKFwibGVmdFwiLCBjdXJyZW50Vm9sdW1lICsgXCIlXCIpO1xuICAgICAgXG4gICAgfSBlbHNlIGlmIChjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlciA9PT0gc29uZ051bWJlcil7XG4gICAgICBpZihjdXJyZW50U29uZ0ZpbGUuaXNQYXVzZWQoKSl7XG4gICAgICAgICQodGhpcykuaHRtbChwYXVzZUJ1dHRvblRlbXBsYXRlKTtcbiAgICAgICAgJHBsYXlQYXVzZVRvZ2dsZS5odG1sKHBsYXllckJhclBhdXNlQnV0dG9uKTtcbiAgICAgICAgY3VycmVudFNvbmdGaWxlLnBsYXkoKTtcbiAgICAgICAgdXBkYXRlU2Vla0JhcldoaWxlU29uZ1BsYXlzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKHRoaXMpLmh0bWwocGxheUJ1dHRvblRlbXBsYXRlKTtcbiAgICAgICAgJHBsYXlQYXVzZVRvZ2dsZS5odG1sKHBsYXllckJhclBsYXlCdXR0b24pO1xuICAgICAgICBjdXJyZW50U29uZ0ZpbGUucGF1c2UoKTsgICAgICAgIFxuICAgICAgfVxuICAgIH1cblxuICB9O1xuXG4gIHZhciBvbkhvdmVyID0gZnVuY3Rpb24oZXZlbnQpe1xuICAgIHZhciBzb25nTnVtYmVyQ29udGFpbmVyID0gJCh0aGlzKS5maW5kKFwiLnNvbmctaXRlbS1udW1iZXJcIik7XG4gICAgdmFyIHNvbmdOdW1iZXIgPSBzb25nTnVtYmVyQ29udGFpbmVyLmF0dHIoXCJkYXRhLXNvbmctbnVtYmVyXCIpO1xuXG4gICAgaWYoc29uZ051bWJlciAhPT0gY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIpe1xuICAgICAgc29uZ051bWJlckNvbnRhaW5lci5odG1sKHBsYXlCdXR0b25UZW1wbGF0ZSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvZmZIb3ZlciA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgICB2YXIgc29uZ051bWJlckNvbnRhaW5lciA9ICQodGhpcykuZmluZChcIi5zb25nLWl0ZW0tbnVtYmVyXCIpO1xuICAgIHZhciBzb25nTnVtYmVyID0gc29uZ051bWJlckNvbnRhaW5lci5hdHRyKFwiZGF0YS1zb25nLW51bWJlclwiKTtcblxuICAgIGlmKHNvbmdOdW1iZXIgIT09IGN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyKXtcbiAgICAgIHNvbmdOdW1iZXJDb250YWluZXIuaHRtbChzb25nTnVtYmVyKTtcbiAgICB9XG4gIH07XG5cbiAgJHJvdy5maW5kKFwiLnNvbmctaXRlbS1udW1iZXJcIikuY2xpY2soY2xpY2tIYW5kbGVyKTtcbiAgJHJvdy5ob3ZlcihvbkhvdmVyLCBvZmZIb3Zlcik7XG4gIHJldHVybiAkcm93O1xufTtcblxudmFyIGZpbHRlclRpbWVDb2RlID0gZnVuY3Rpb24odGltZUluU2Vjb25kcyl7XG4gIHZhciB0aW1lSW5NaW51dGVzID0gcGFyc2VGbG9hdCh0aW1lSW5TZWNvbmRzKSAvIDYwO1xuICB2YXIgbWludXRlcyA9IE1hdGguZmxvb3IodGltZUluTWludXRlcyk7XG4gIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcigodGltZUluTWludXRlcyAtIG1pbnV0ZXMpICogMTAwKTtcbiAgaWYoc2Vjb25kcyA8IDEwKVxuICAgIHJldHVybiBtaW51dGVzICsgXCI6MFwiICsgc2Vjb25kcztcbiAgZWxzZVxuICAgIHJldHVybiBtaW51dGVzICsgXCI6XCIgKyBzZWNvbmRzO1xufTtcblxudmFyIGdldFNvbmdOdW1iZXJDb250YWluZXIgPSBmdW5jdGlvbihudW1iZXIpe1xuICByZXR1cm4gJChcIi5zb25nLWl0ZW0tbnVtYmVyW2RhdGEtc29uZy1udW1iZXI9J1wiICsgbnVtYmVyICsgXCInXVwiKTtcbn07XG5cbnZhciBuZXh0U29uZyA9IGZ1bmN0aW9uKCl7XG4gIHZhciBnZXRMYXN0U29uZ051bWJlciA9IGZ1bmN0aW9uKGluZGV4KXtcbiAgICByZXR1cm4gaW5kZXggPT09IDAgPyBjdXJyZW50QWxidW0uc29uZ3MubGVuZ3RoIDogaW5kZXg7XG4gIH07XG5cbiAgdmFyIGN1cnJlbnRTb25nSW5kZXggPSB0cmFja0luZGV4KGN1cnJlbnRBbGJ1bSwgY3VycmVudFNvbmdGcm9tQWxidW0pO1xuICBjdXJyZW50U29uZ0luZGV4Kys7XG5cbiAgaWYoY3VycmVudFNvbmdJbmRleCA+PSBjdXJyZW50QWxidW0uc29uZ3MubGVuZ3RoKXtcbiAgICBjdXJyZW50U29uZ0luZGV4ID0gMDtcbiAgfVxuXG4gIHNldFNvbmcoY3VycmVudFNvbmdJbmRleCArIDEpO1xuICBjdXJyZW50U29uZ0ZpbGUucGxheSgpO1xuICB1cGRhdGVQbGF5ZXJCYXJTb25nKCk7XG4gIHVwZGF0ZVNlZWtCYXJXaGlsZVNvbmdQbGF5cygpO1xuXG4gIHZhciBsYXN0U29uZ051bWJlciA9IGdldExhc3RTb25nTnVtYmVyKGN1cnJlbnRTb25nSW5kZXgpO1xuICB2YXIgJG5leHRTb25nTnVtYmVyQ2VsbCA9IGdldFNvbmdOdW1iZXJDb250YWluZXIoY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIpO1xuICB2YXIgJGxhc3RTb25nTnVtYmVyQ2VsbCA9IGdldFNvbmdOdW1iZXJDb250YWluZXIobGFzdFNvbmdOdW1iZXIpO1xuXG4gICRuZXh0U29uZ051bWJlckNlbGwuaHRtbChwYXVzZUJ1dHRvblRlbXBsYXRlKTtcbiAgJGxhc3RTb25nTnVtYmVyQ2VsbC5odG1sKGxhc3RTb25nTnVtYmVyKTtcbn07XG5cbnZhciBwcmV2aW91c1NvbmcgPSBmdW5jdGlvbigpe1xuICB2YXIgZ2V0TGFzdFNvbmdOdW1iZXIgPSBmdW5jdGlvbihpbmRleCl7XG4gICAgcmV0dXJuIGluZGV4ID09IChjdXJyZW50QWxidW0uc29uZ3MubGVuZ3RoIC0gMSkgPyAxIDogaW5kZXggKyAyO1xuICB9O1xuXG4gIHZhciBjdXJyZW50U29uZ0luZGV4ID0gdHJhY2tJbmRleChjdXJyZW50QWxidW0sIGN1cnJlbnRTb25nRnJvbUFsYnVtKTtcbiAgY3VycmVudFNvbmdJbmRleC0tO1xuXG4gIGlmKGN1cnJlbnRTb25nSW5kZXggPCAwKSB7XG4gICAgY3VycmVudFNvbmdJbmRleCA9IGN1cnJlbnRBbGJ1bS5zb25ncy5sZW5ndGggLSAxO1xuICB9XG5cbiAgc2V0U29uZyhjdXJyZW50U29uZ0luZGV4ICsgMSk7XG4gIGN1cnJlbnRTb25nRmlsZS5wbGF5KCk7XG4gIHVwZGF0ZVBsYXllckJhclNvbmcoKTtcbiAgdXBkYXRlU2Vla0JhcldoaWxlU29uZ1BsYXlzKCk7XG5cbiAgdmFyIGxhc3RTb25nTnVtYmVyID0gZ2V0TGFzdFNvbmdOdW1iZXIoY3VycmVudFNvbmdJbmRleCk7XG4gIHZhciAkcHJldmlvdXNTb25nTnVtYmVyQ2VsbCA9IGdldFNvbmdOdW1iZXJDb250YWluZXIoY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIpO1xuICB2YXIgJGxhc3RTb25nTnVtYmVyQ2VsbCA9IGdldFNvbmdOdW1iZXJDb250YWluZXIobGFzdFNvbmdOdW1iZXIpO1xuXG4gICRwcmV2aW91c1NvbmdOdW1iZXJDZWxsLmh0bWwocGF1c2VCdXR0b25UZW1wbGF0ZSk7XG4gICRsYXN0U29uZ051bWJlckNlbGwuaHRtbChsYXN0U29uZ051bWJlcik7ICBcbn07XG5cbnZhciBzZWVrID0gZnVuY3Rpb24odGltZSl7XG4gIGlmKGN1cnJlbnRTb25nRmlsZSl7XG4gICAgY3VycmVudFNvbmdGaWxlLnNldFRpbWUodGltZSk7XG4gIH1cbn07XG5cbnZhciBzZXRDdXJyZW50QWxidW0gPSBmdW5jdGlvbihhbGJ1bSkge1xuICBjdXJyZW50QWxidW0gPSBhbGJ1bTtcblxuICB2YXIgJGFsYnVtVGl0bGUgPSAkKFwiLmFsYnVtLXZpZXctdGl0bGVcIik7XG4gIHZhciAkYWxidW1BcnRpc3QgPSAkKFwiLmFsYnVtLXZpZXctYXJ0aXN0XCIpO1xuICB2YXIgJGFsYnVtUmVsZWFzZUluZm8gPSAkKFwiLmFsYnVtLXZpZXctcmVsZWFzZS1pbmZvXCIpO1xuICB2YXIgJGFsYnVtSW1hZ2UgPSAkKFwiLmFsYnVtLWNvdmVyLWFydFwiKTtcbiAgdmFyICRhbGJ1bVNvbmdMaXN0ID0gJChcIi5hbGJ1bS12aWV3LXNvbmctbGlzdFwiKTtcblxuICAkYWxidW1UaXRsZS50ZXh0KGFsYnVtLnRpdGxlKTtcbiAgJGFsYnVtQXJ0aXN0LnRleHQoYWxidW0uYXJ0aXN0KTtcbiAgJGFsYnVtUmVsZWFzZUluZm8udGV4dChhbGJ1bS55ZWFyICsgXCIgXCIgKyBhbGJ1bS5sYWJlbCk7XG4gICRhbGJ1bUltYWdlLmF0dHIoXCJzcmNcIiwgYWxidW0uYWxidW1BcnRVcmwpO1xuXG4gICRhbGJ1bVNvbmdMaXN0LmVtcHR5KCk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGJ1bS5zb25ncy5sZW5ndGg7IGkrKykge1xuICAgIHZhciAkbmV3Um93ID0gY3JlYXRlU29uZ1JvdyhpICsgMSwgYWxidW0uc29uZ3NbaV0udGl0bGUsIGFsYnVtLnNvbmdzW2ldLmR1cmF0aW9uKTtcbiAgICAkYWxidW1Tb25nTGlzdC5hcHBlbmQoJG5ld1Jvdyk7XG4gIH1cbn07XG5cbnZhciBzZXRDdXJyZW50VGltZUluUGxheWVyQmFyID0gZnVuY3Rpb24oY3VycmVudFRpbWUpe1xuICAkY3VycmVudFRpbWVDb250YWluZXIuaHRtbChmaWx0ZXJUaW1lQ29kZShjdXJyZW50VGltZSkpO1xufTtcblxudmFyIHNldFNvbmcgPSBmdW5jdGlvbihzb25nTnVtYmVyKXtcbiAgaWYoY3VycmVudFNvbmdGaWxlKXtcbiAgICBjdXJyZW50U29uZ0ZpbGUuc3RvcCgpO1xuICB9XG4gIGN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyID0gc29uZ051bWJlcjtcbiAgY3VycmVudFNvbmdGcm9tQWxidW0gPSBjdXJyZW50QWxidW0uc29uZ3Nbc29uZ051bWJlciAtIDFdO1xuXG4gIGN1cnJlbnRTb25nRmlsZSA9IG5ldyBidXp6LnNvdW5kKGN1cnJlbnRTb25nRnJvbUFsYnVtLmF1ZGlvVXJsLCB7XG4gICAgZm9ybWF0czogW1wibXAzXCJdLFxuICAgIHByZWxvYWQ6IHRydWVcbiAgfSk7XG5cbiAgc2V0Vm9sdW1lKGN1cnJlbnRWb2x1bWUpO1xuXG4gICQoXCIuY3VycmVudGx5LXBsYXlpbmcgLnNvbmctbmFtZVwiKS50ZXh0KGN1cnJlbnRTb25nRnJvbUFsYnVtLnRpdGxlKTtcbiAgJChcIi5jdXJyZW50bHktcGxheWluZyAuYXJ0aXN0LW5hbWVcIikudGV4dChjdXJyZW50U29uZ0Zyb21BbGJ1bS5hcnRpc3QpO1xuICAkKFwiLmN1cnJlbnRseS1wbGF5aW5nIC5hcnRpc3Qtc29uZy1tb2JpbGVcIikudGV4dChjdXJyZW50U29uZ0Zyb21BbGJ1bS50aXRsZSArIFwiIC0gXCIgKyBjdXJyZW50QWxidW0udGl0bGUpO1xuXG4gICRwbGF5UGF1c2VUb2dnbGUuaHRtbChwbGF5ZXJCYXJQYXVzZUJ1dHRvbik7XG59O1xuXG52YXIgc2V0VG90YWxUaW1lSW5QbGF5ZXJCYXIgPSBmdW5jdGlvbih0b3RhbFRpbWUpe1xuICAkdG90YWxUaW1lQ29udGFpbmVyLmh0bWwoZmlsdGVyVGltZUNvZGUodG90YWxUaW1lKSk7XG59O1xuXG52YXIgc2V0Vm9sdW1lID0gZnVuY3Rpb24odm9sdW1lKXtcbiAgaWYoY3VycmVudFNvbmdGaWxlKXtcbiAgICBjdXJyZW50U29uZ0ZpbGUuc2V0Vm9sdW1lKHZvbHVtZSk7XG4gIH1cbn07XG5cbnZhciBzZXR1cFNlZWtCYXJzID0gZnVuY3Rpb24oKXtcbiAgdmFyICRzZWVrQmFycyA9ICQoXCIucGxheWVyLWJhciAuc2Vlay1iYXJcIik7XG5cbiAgJHNlZWtCYXJzLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KXtcblxuICAgIHZhciBvZmZzZXRYID0gZXZlbnQucGFnZVggLSAkKHRoaXMpLm9mZnNldCgpLmxlZnQ7XG4gICAgdmFyIGJhcldpZHRoID0gJCh0aGlzKS53aWR0aCgpO1xuXG4gICAgdmFyIHNlZWtCYXJGaWxsUmF0aW8gPSBvZmZzZXRYIC8gYmFyV2lkdGg7XG5cbiAgICBpZigkKHRoaXMpLnBhcmVudCgpLmhhc0NsYXNzKFwidm9sdW1lXCIpKXtcbiAgICAgIHNldFZvbHVtZShzZWVrQmFyRmlsbFJhdGlvICogMTAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VlayhzZWVrQmFyRmlsbFJhdGlvICogY3VycmVudFNvbmdGaWxlLmdldER1cmF0aW9uKCkpO1xuICAgIH1cblxuICAgIHVwZGF0ZVNlZWtQZXJjZW50YWdlKCQodGhpcyksIHNlZWtCYXJGaWxsUmF0aW8pO1xuICB9KTtcblxuICAkc2Vla0JhcnMuZmluZChcIi50aHVtYlwiKS5tb3VzZWRvd24oZnVuY3Rpb24oZXZlbnQpe1xuICAgIHZhciAkY3VycmVudFNlZWtCYXIgPSAkKHRoaXMpLnBhcmVudCgpO1xuXG4gICAgJChkb2N1bWVudCkuYmluZChcIm1vdXNlbW92ZS50aHVtYlwiLCBmdW5jdGlvbihldmVudCl7XG4gICAgICB2YXIgb2Zmc2V0WCA9IGV2ZW50LnBhZ2VYIC0gJGN1cnJlbnRTZWVrQmFyLm9mZnNldCgpLmxlZnQ7XG4gICAgICB2YXIgYmFyV2lkdGggPSAkY3VycmVudFNlZWtCYXIud2lkdGgoKTtcbiAgICAgIHZhciBzZWVrQmFyRmlsbFJhdGlvID0gb2Zmc2V0WCAvIGJhcldpZHRoO1xuXG4gICAgICBpZigkKHRoaXMpLnBhcmVudCgpLmhhc0NsYXNzKFwidm9sdW1lXCIpKXtcbiAgICAgICAgc2V0Vm9sdW1lKHNlZWtCYXJGaWxsUmF0aW8pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VlayhzZWVrQmFyRmlsbFJhdGlvICogY3VycmVudFNvbmdGaWxlLmdldER1cmF0aW9uKCkpO1xuICAgICAgfSAgICAgIFxuXG4gICAgICB1cGRhdGVTZWVrUGVyY2VudGFnZSgkY3VycmVudFNlZWtCYXIsIHNlZWtCYXJGaWxsUmF0aW8pO1xuICAgIH0pO1xuXG4gICAgJChkb2N1bWVudCkuYmluZChcIm1vdXNldXAudGh1bWJcIiwgZnVuY3Rpb24oKXtcbiAgICAgICQoZG9jdW1lbnQpLnVuYmluZChcIm1vdXNlbW92ZS50aHVtYlwiKTtcbiAgICAgICQoZG9jdW1lbnQpLnVuYmluZChcIm1vdXNldXAudGh1bWJcIik7XG4gICAgfSk7XG4gIH0pO1xufTtcblxudmFyIHRvZ2dsZVBsYXlGcm9tUGxheWVyQmFyID0gZnVuY3Rpb24oKSB7XG4gIGlmKGN1cnJlbnRTb25nRmlsZS5pc1BhdXNlZCgpKXtcbiAgICAkcGxheVBhdXNlVG9nZ2xlLmh0bWwocGxheWVyQmFyUGF1c2VCdXR0b24pO1xuICAgIGdldFNvbmdOdW1iZXJDb250YWluZXIoY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIpLmh0bWwocGF1c2VCdXR0b25UZW1wbGF0ZSk7XG4gICAgY3VycmVudFNvbmdGaWxlLnBsYXkoKTtcbiAgfSBlbHNlIHtcbiAgICAkcGxheVBhdXNlVG9nZ2xlLmh0bWwocGxheWVyQmFyUGxheUJ1dHRvbik7XG4gICAgZ2V0U29uZ051bWJlckNvbnRhaW5lcihjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlcikuaHRtbChjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlcik7XG4gICAgY3VycmVudFNvbmdGaWxlLnBhdXNlKCk7XG4gIH1cbn07XG5cbnZhciB0cmFja0luZGV4ID0gZnVuY3Rpb24oYWxidW0sIHNvbmcpe1xuICByZXR1cm4gYWxidW0uc29uZ3MuaW5kZXhPZihzb25nKTtcbn07XG5cbnZhciB1cGRhdGVQbGF5ZXJCYXJTb25nID0gZnVuY3Rpb24oKXtcbiAgJHBsYXlQYXVzZVRvZ2dsZS5odG1sKHBsYXllckJhclBhdXNlQnV0dG9uKTtcbn07XG5cbnZhciB1cGRhdGVTZWVrQmFyV2hpbGVTb25nUGxheXMgPSBmdW5jdGlvbigpe1xuICBpZihjdXJyZW50U29uZ0ZpbGUpe1xuICAgIGN1cnJlbnRTb25nRmlsZS5iaW5kKFwidGltZXVwZGF0ZVwiLCBmdW5jdGlvbihldmVudCl7XG4gICAgICB2YXIgc2Vla0JhckZpbGxSYXRpbyA9IHRoaXMuZ2V0VGltZSgpIC8gdGhpcy5nZXREdXJhdGlvbigpO1xuICAgICAgdmFyICRzZWVrQmFyID0gJChcIi5zZWVrLWNvbnRyb2wgLnNlZWstYmFyXCIpO1xuICAgICAgdXBkYXRlU2Vla1BlcmNlbnRhZ2UoJHNlZWtCYXIsIHNlZWtCYXJGaWxsUmF0aW8pO1xuICAgICAgc2V0Q3VycmVudFRpbWVJblBsYXllckJhcih0aGlzLmdldFRpbWUoKSk7XG4gICAgICBzZXRUb3RhbFRpbWVJblBsYXllckJhcih0aGlzLmdldER1cmF0aW9uKCkpO1xuICAgIH0pO1xuICB9XG59O1xuXG52YXIgdXBkYXRlU2Vla1BlcmNlbnRhZ2UgPSBmdW5jdGlvbigkc2Vla0Jhciwgc2Vla0JhckZpbGxSYXRpbyl7XG4gIHZhciBvZmZzZXRYUGVyY2VudCA9IHNlZWtCYXJGaWxsUmF0aW8gKiAxMDA7XG4gIG9mZnNldFhQZXJjZW50ID0gTWF0aC5tYXgoMCwgb2Zmc2V0WFBlcmNlbnQpO1xuICBvZmZzZXRYUGVyY2VudCA9IE1hdGgubWluKDEwMCwgb2Zmc2V0WFBlcmNlbnQpO1xuXG4gIHZhciBwZXJjZW50YWdlU3RyaW5nID0gb2Zmc2V0WFBlcmNlbnQgKyBcIiVcIjtcbiAgJHNlZWtCYXIuZmluZChcIi5maWxsXCIpLndpZHRoKHBlcmNlbnRhZ2VTdHJpbmcpO1xuICAkc2Vla0Jhci5maW5kKFwiLnRodW1iXCIpLmNzcyh7bGVmdDogcGVyY2VudGFnZVN0cmluZ30pO1xufTtcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7IFxuICBzZXRDdXJyZW50QWxidW0oYWxidW1QaWNhc3NvKTtcbiAgc2V0dXBTZWVrQmFycygpO1xuICAkcHJldmlvdXNCdXR0b24uY2xpY2socHJldmlvdXNTb25nKTtcbiAgJG5leHRCdXR0b24uY2xpY2sobmV4dFNvbmcpO1xuICAkcGxheVBhdXNlVG9nZ2xlLmNsaWNrKHRvZ2dsZVBsYXlGcm9tUGxheWVyQmFyKTtcbiAgdmFyIGFsYnVtQ292ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFsYnVtLWNvdmVyXCIpOyBcbn0pO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
