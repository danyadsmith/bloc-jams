var albumPicasso={title:"The Colors",artist:"Pablo Picasso",label:"Cubism",year:"1881",albumArtUrl:"assets/images/album_covers/01.png",songs:[{title:"Blue",duration:"4:26"},{title:"Green",duration:"3:14"},{title:"Red",duration:"5:01"},{title:"Pink",duration:"3:21"},{title:"Magenta",duration:"2:15"}]},albumMarconi={title:"The Telephone",artist:"Guglielmo Marconi",label:"EM",year:"1909",albumArtUrl:"assets/images/album_covers/20.png",songs:[{title:"Hello Operator?",duration:"1:01"},{title:"Ring, ring, ring",duration:"5:01"},{title:"Fits in your pocket",duration:"3:21"},{title:"Can you hear me now?",duration:"3:14"},{title:"Wrong phone number",duration:"2:15"}]},albumPurpleRain={title:"Purple Rain",artist:"Prince",label:"Warner Bros.",year:"1984",albumArtUrl:"assets/images/album_covers/22.jpg",songs:[{title:"Let's Go Crazy",duration:"4:39"},{title:"Take Me With U",duration:"3:54"},{title:"The Beautiful Ones",duration:"5:14"},{title:"Computer Blue",duration:"4:00"},{title:"Darling Nikki",duration:"4:15"},{title:"When Doves Cry",duration:"5:54"},{title:"I Would Die 4 U",duration:"2:49"},{title:"Baby I'm A Star",duration:"4:25"},{title:"Purple Rain",duration:"8:42"}]},playButtonTemplate='<a class="album-song-button"><span class="ion-play"></span></a>',pauseButtonTemplate='<a class="album-song-button"><span class="ion-pause"></span></a>',currentlyPlayingSong=null,albumList=[albumPicasso,albumMarconi,albumPurpleRain],counter=0,createSongRow=function(e,t,n){var a='<tr class="album-view-song-item">  <td class="song-item-number" data-song-number="'+e+'">'+e+'</td>  <td class="song-item-title">'+t+'</td>  <td class="song-item-duration">'+n+"</td></tr>";return $(a)},setCurrentAlbum=function(e){var t=$(".album-view-title"),n=$(".album-view-artist"),a=$(".album-view-release-info"),r=$(".album-cover-art"),l=$(".album-view-song-list");t.text(e.title),n.text(e.artist),a.text(e.year+" "+e.label),r.attr("src",e.albumArtUrl),l.empty();for(var o=0;o<e.songs.length;o++){var i=createSongRow(o+1,e.songs[o].title,e.songs[o].duration);l.append(i)}},findParentByClassName=function(e,t){var n;if(e)if(n=e.parentElement||null,null===n)console.log("No parent found for "+e+".");else{for(;n.className!==t&&null!==n.className;)n=n.parentElement;if(n.className!==t)return console.log("No parent found with the class name "+t+"."),n;console.log("No "+e+" element found.")}},getSongItem=function(e){switch(e.className){case"album-song-button":case"ion-play":case"ion-pause":return findParentByClassName(e,"song-item-number");case"album-view-song-item":return e.querySelector(".song-item-number");case"song-item-title":case"song-item-duration":return findParentByClassName(e,"album-view-song-item").querySelector(".song-item-number");case"song-item-number":return e;default:return}},clickHandler=function(e){var t=getSongItem(e);if(null===currentlyPlayingSong)t.innerHTML=pauseButtonTemplate,currentlyPlayingSong=t.getAttribute("data-song-number");else if(currentlyPlayingSong===t.getAttribute("data-song-number"))t.innerHTML=playButtonTemplate,currentlyPlayingSong=null;else if(currentlyPlayingSong!==t.getAttribute("data-song-number")){var n=document.querySelector('[data-song-number="'+currentlyPlayingSong+'"]');n.innerHTML=n.getAttribute("data-song-number"),t.innerHTML=pauseButtonTemplate,currentlyPlayingSong=t.getAttribute("data-song-number")}};window.onload=function(){setCurrentAlbum(albumPicasso),albumCover=document.getElementById("album-cover"),songListContainer=document.getElementsByClassName("album-view-song-list")[0],songRows=document.getElementsByClassName("album-view-song-item"),albumCover.addEventListener("click",function(e){setCurrentAlbum(albumList[counter]),counter++,counter>=albumList.length&&(counter=0)},!1),songListContainer.addEventListener("mouseover",function(e){if("album-view-song-item"===e.target.parentElement.className){e.target.parentElement.querySelector(".song-item-number").innerHTML=playButtonTemplate;var t=getSongItem(e.target);t.getAttribute("data-song-number")!==currentlyPlayingSong&&(t.innerHTML=playButtonTemplate)}});for(var e=0;e<songRows.length;e++)songRows[e].addEventListener("mouseleave",function(e){var t=getSongItem(e.target),n=t.getAttribute("data-song-number");n!==currentlyPlayingSong&&(t.innerHTML=n)}),songRows[e].addEventListener("click",function(e){clickHandler(e.target)})};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsYnVtLmpzIl0sIm5hbWVzIjpbImFsYnVtUGljYXNzbyIsInRpdGxlIiwiYXJ0aXN0IiwibGFiZWwiLCJ5ZWFyIiwiYWxidW1BcnRVcmwiLCJzb25ncyIsImR1cmF0aW9uIiwiYWxidW1NYXJjb25pIiwiYWxidW1QdXJwbGVSYWluIiwicGxheUJ1dHRvblRlbXBsYXRlIiwicGF1c2VCdXR0b25UZW1wbGF0ZSIsImN1cnJlbnRseVBsYXlpbmdTb25nIiwiYWxidW1MaXN0IiwiY291bnRlciIsImNyZWF0ZVNvbmdSb3ciLCJzb25nTnVtYmVyIiwic29uZ05hbWUiLCJzb25nTGVuZ3RoIiwidGVtcGxhdGUiLCIkIiwic2V0Q3VycmVudEFsYnVtIiwiYWxidW0iLCIkYWxidW1UaXRsZSIsIiRhbGJ1bUFydGlzdCIsIiRhbGJ1bVJlbGVhc2VJbmZvIiwiJGFsYnVtSW1hZ2UiLCIkYWxidW1Tb25nTGlzdCIsInRleHQiLCJhdHRyIiwiZW1wdHkiLCJpIiwibGVuZ3RoIiwiJG5ld1JvdyIsImFwcGVuZCIsImZpbmRQYXJlbnRCeUNsYXNzTmFtZSIsImVsZW1lbnQiLCJwYXJlbnRDbGFzc05hbWUiLCJwYXJlbnRFbGVtZW50IiwiY29uc29sZSIsImxvZyIsImNsYXNzTmFtZSIsImdldFNvbmdJdGVtIiwicXVlcnlTZWxlY3RvciIsImNsaWNrSGFuZGxlciIsInRhcmdldEVsZW1lbnQiLCJzb25nSXRlbSIsImlubmVySFRNTCIsImdldEF0dHJpYnV0ZSIsImN1cnJlbnRseVBsYXlpbmdTb25nRWxlbWVudCIsImRvY3VtZW50Iiwid2luZG93Iiwib25sb2FkIiwiYWxidW1Db3ZlciIsImdldEVsZW1lbnRCeUlkIiwic29uZ0xpc3RDb250YWluZXIiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwic29uZ1Jvd3MiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJzb25nSXRlbU51bWJlciJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsZUFDRkMsTUFBTyxhQUNQQyxPQUFRLGdCQUNSQyxNQUFPLFNBQ1BDLEtBQU0sT0FDTkMsWUFBYSxvQ0FDYkMsUUFDSUwsTUFBTyxPQUFRTSxTQUFVLFNBQ3pCTixNQUFPLFFBQVNNLFNBQVUsU0FDMUJOLE1BQU8sTUFBT00sU0FBVSxTQUN4Qk4sTUFBTyxPQUFRTSxTQUFVLFNBQ3pCTixNQUFPLFVBQVdNLFNBQVUsVUFJOUJDLGNBQ0ZQLE1BQU8sZ0JBQ1BDLE9BQVEsb0JBQ1JDLE1BQU8sS0FDUEMsS0FBTSxPQUNOQyxZQUFhLG9DQUNiQyxRQUNJTCxNQUFPLGtCQUFtQk0sU0FBVSxTQUNwQ04sTUFBTyxtQkFBb0JNLFNBQVUsU0FDckNOLE1BQU8sc0JBQXVCTSxTQUFVLFNBQ3hDTixNQUFPLHVCQUF3Qk0sU0FBVSxTQUN6Q04sTUFBTyxxQkFBc0JNLFNBQVUsVUFJekNFLGlCQUNGUixNQUFPLGNBQ1BDLE9BQVEsU0FDUkMsTUFBTyxlQUNQQyxLQUFNLE9BQ05DLFlBQWEsb0NBQ2JDLFFBQ0lMLE1BQU8saUJBQW1CTSxTQUFVLFNBQ3BDTixNQUFPLGlCQUFrQk0sU0FBVSxTQUNuQ04sTUFBTyxxQkFBc0JNLFNBQVUsU0FDdkNOLE1BQU8sZ0JBQWlCTSxTQUFVLFNBQ2xDTixNQUFPLGdCQUFpQk0sU0FBVSxTQUNsQ04sTUFBTyxpQkFBa0JNLFNBQVUsU0FDbkNOLE1BQU8sa0JBQW1CTSxTQUFVLFNBQ3BDTixNQUFPLGtCQUFvQk0sU0FBVSxTQUNyQ04sTUFBTyxjQUFlTSxTQUFVLFVBSWxDRyxtQkFBcUIsa0VBQ3JCQyxvQkFBc0IsbUVBQ3RCQyxxQkFBdUIsS0FDdkJDLFdBQWFiLGFBQWNRLGFBQWNDLGlCQUN6Q0ssUUFBVSxFQUVWQyxjQUFnQixTQUFTQyxFQUFZQyxFQUFVQyxHQUNqRCxHQUFJQyxHQUNBLHFGQUNzREgsRUFBYSxLQUFPQSxFQUFhLHNDQUNwREMsRUFBVyx5Q0FDUkMsRUFBYSxZQUd2RCxPQUFPRSxHQUFFRCxJQUdQRSxnQkFBa0IsU0FBU0MsR0FFN0IsR0FBSUMsR0FBY0gsRUFBRSxxQkFDaEJJLEVBQWVKLEVBQUUsc0JBQ2pCSyxFQUFvQkwsRUFBRSw0QkFDdEJNLEVBQWNOLEVBQUUsb0JBQ2hCTyxFQUFpQlAsRUFBRSx3QkFHdkJHLEdBQVlLLEtBQUtOLEVBQU1yQixPQUN2QnVCLEVBQWFJLEtBQUtOLEVBQU1wQixRQUN4QnVCLEVBQWtCRyxLQUFLTixFQUFNbEIsS0FBTyxJQUFNa0IsRUFBTW5CLE9BQ2hEdUIsRUFBWUcsS0FBSyxNQUFPUCxFQUFNakIsYUFHOUJzQixFQUFlRyxPQUdmLEtBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJVCxFQUFNaEIsTUFBTTBCLE9BQVFELElBQUssQ0FDM0MsR0FBSUUsR0FBVWxCLGNBQWNnQixFQUFJLEVBQUdULEVBQU1oQixNQUFNeUIsR0FBRzlCLE1BQU9xQixFQUFNaEIsTUFBTXlCLEdBQUd4QixTQUN4RW9CLEdBQWVPLE9BQU9ELEtBSXRCRSxzQkFBd0IsU0FBU0MsRUFBU0MsR0FDNUMsR0FBSUMsRUFDSixJQUFHRixFQUVELEdBREFFLEVBQWdCRixFQUFRRSxlQUFpQixLQUNwQixPQUFsQkEsRUFBeUJDLFFBQVFDLElBQUksdUJBQXlCSixFQUFVLFNBQ3BFLENBQ0wsS0FBTUUsRUFBY0csWUFBY0osR0FBK0MsT0FBNUJDLEVBQWNHLFdBQ2pFSCxFQUFnQkEsRUFBY0EsYUFFaEMsSUFBR0EsRUFBY0csWUFBY0osRUFDN0IsTUFEK0NFLFNBQVFDLElBQUksdUNBQXlDSCxFQUFrQixLQUMvR0MsQ0FFUEMsU0FBUUMsSUFBSSxNQUFRSixFQUFVLHFCQU1sQ00sWUFBYyxTQUFTTixHQUN6QixPQUFRQSxFQUFRSyxXQUNaLElBQUssb0JBQ0wsSUFBSyxXQUNMLElBQUssWUFDRCxNQUFPTix1QkFBc0JDLEVBQVMsbUJBQzFDLEtBQUssdUJBQ0QsTUFBT0EsR0FBUU8sY0FBYyxvQkFDakMsS0FBSyxrQkFDTCxJQUFLLHFCQUNELE1BQU9SLHVCQUFzQkMsRUFBUyx3QkFBd0JPLGNBQWMsb0JBQ2hGLEtBQUssbUJBQ0QsTUFBT1AsRUFDWCxTQUNJLFNBSU5RLGFBQWUsU0FBU0MsR0FDMUIsR0FBSUMsR0FBV0osWUFBWUcsRUFDM0IsSUFBNkIsT0FBekJqQyxxQkFDRmtDLEVBQVNDLFVBQVlwQyxvQkFDckJDLHFCQUF1QmtDLEVBQVNFLGFBQWEsd0JBRTFDLElBQUlwQyx1QkFBeUJrQyxFQUFTRSxhQUFhLG9CQUN0REYsRUFBU0MsVUFBWXJDLG1CQUNyQkUscUJBQXVCLFNBRXBCLElBQUlBLHVCQUF5QmtDLEVBQVNFLGFBQWEsb0JBQXFCLENBQzNFLEdBQUlDLEdBQThCQyxTQUFTUCxjQUFjLHNCQUF3Qi9CLHFCQUF1QixLQUN4R3FDLEdBQTRCRixVQUFZRSxFQUE0QkQsYUFBYSxvQkFDakZGLEVBQVNDLFVBQVlwQyxvQkFDckJDLHFCQUF1QmtDLEVBQVNFLGFBQWEscUJBSWpERyxRQUFPQyxPQUFTLFdBQ2QvQixnQkFBZ0JyQixjQUNoQnFELFdBQWFILFNBQVNJLGVBQWUsZUFDckNDLGtCQUFvQkwsU0FBU00sdUJBQXVCLHdCQUF3QixHQUM1RUMsU0FBV1AsU0FBU00sdUJBQXVCLHdCQUUzQ0gsV0FBV0ssaUJBQWlCLFFBQVMsU0FBU0MsR0FFNUN0QyxnQkFBZ0JSLFVBQVVDLFVBQzFCQSxVQUNHQSxTQUFXRCxVQUFVbUIsU0FBU2xCLFFBQVUsS0FDMUMsR0FFSHlDLGtCQUFrQkcsaUJBQWlCLFlBQWEsU0FBU0MsR0FFdkQsR0FBNEMseUJBQXpDQSxFQUFNQyxPQUFPdEIsY0FBY0csVUFBcUMsQ0FDakVrQixFQUFNQyxPQUFPdEIsY0FBY0ssY0FBYyxxQkFBcUJJLFVBQVlyQyxrQkFDMUUsSUFBSW9DLEdBQVdKLFlBQVlpQixFQUFNQyxPQUM3QmQsR0FBU0UsYUFBYSxzQkFBd0JwQyx1QkFDaERrQyxFQUFTQyxVQUFZckMsc0JBSzNCLEtBQUksR0FBSXFCLEdBQUksRUFBR0EsRUFBSTBCLFNBQVN6QixPQUFRRCxJQUNsQzBCLFNBQVMxQixHQUFHMkIsaUJBQWlCLGFBQWMsU0FBU0MsR0FDbEQsR0FBSWIsR0FBV0osWUFBWWlCLEVBQU1DLFFBQzdCQyxFQUFpQmYsRUFBU0UsYUFBYSxtQkFFdkNhLEtBQW1CakQsdUJBQ3BCa0MsRUFBU0MsVUFBWWMsS0FJMUJKLFNBQVMxQixHQUFHMkIsaUJBQWlCLFFBQVMsU0FBU0MsR0FDN0NmLGFBQWFlLEVBQU1DIiwiZmlsZSI6ImFsYnVtLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFsYnVtUGljYXNzbyA9IHtcbiAgdGl0bGU6ICdUaGUgQ29sb3JzJyxcbiAgYXJ0aXN0OiAnUGFibG8gUGljYXNzbycsXG4gIGxhYmVsOiAnQ3ViaXNtJyxcbiAgeWVhcjogJzE4ODEnLFxuICBhbGJ1bUFydFVybDogJ2Fzc2V0cy9pbWFnZXMvYWxidW1fY292ZXJzLzAxLnBuZycsXG4gIHNvbmdzOiBbIFxuICAgIHsgdGl0bGU6ICdCbHVlJywgZHVyYXRpb246ICc0OjI2JyB9LFxuICAgIHsgdGl0bGU6ICdHcmVlbicsIGR1cmF0aW9uOiAnMzoxNCcgfSxcbiAgICB7IHRpdGxlOiAnUmVkJywgZHVyYXRpb246ICc1OjAxJyB9LFxuICAgIHsgdGl0bGU6ICdQaW5rJywgZHVyYXRpb246ICczOjIxJyB9LFxuICAgIHsgdGl0bGU6ICdNYWdlbnRhJywgZHVyYXRpb246ICcyOjE1JyB9XG4gIF1cbn07XG5cbnZhciBhbGJ1bU1hcmNvbmkgPSB7XG4gIHRpdGxlOiAnVGhlIFRlbGVwaG9uZScsXG4gIGFydGlzdDogJ0d1Z2xpZWxtbyBNYXJjb25pJyxcbiAgbGFiZWw6ICdFTScsXG4gIHllYXI6ICcxOTA5JyxcbiAgYWxidW1BcnRVcmw6ICdhc3NldHMvaW1hZ2VzL2FsYnVtX2NvdmVycy8yMC5wbmcnLFxuICBzb25nczogW1xuICAgIHsgdGl0bGU6ICdIZWxsbyBPcGVyYXRvcj8nLCBkdXJhdGlvbjogJzE6MDEnIH0sXG4gICAgeyB0aXRsZTogJ1JpbmcsIHJpbmcsIHJpbmcnLCBkdXJhdGlvbjogJzU6MDEnIH0sXG4gICAgeyB0aXRsZTogJ0ZpdHMgaW4geW91ciBwb2NrZXQnLCBkdXJhdGlvbjogJzM6MjEnIH0sXG4gICAgeyB0aXRsZTogJ0NhbiB5b3UgaGVhciBtZSBub3c/JywgZHVyYXRpb246ICczOjE0JyB9LFxuICAgIHsgdGl0bGU6ICdXcm9uZyBwaG9uZSBudW1iZXInLCBkdXJhdGlvbjogJzI6MTUnIH1cbiAgXVxufTtcblxudmFyIGFsYnVtUHVycGxlUmFpbiA9IHtcbiAgdGl0bGU6ICdQdXJwbGUgUmFpbicsXG4gIGFydGlzdDogJ1ByaW5jZScsXG4gIGxhYmVsOiAnV2FybmVyIEJyb3MuJyxcbiAgeWVhcjogJzE5ODQnLFxuICBhbGJ1bUFydFVybDogJ2Fzc2V0cy9pbWFnZXMvYWxidW1fY292ZXJzLzIyLmpwZycsXG4gIHNvbmdzOiBbXG4gICAgeyB0aXRsZTogJ0xldFxcJ3MgR28gQ3JhenknLCBkdXJhdGlvbjogJzQ6MzknIH0sXG4gICAgeyB0aXRsZTogJ1Rha2UgTWUgV2l0aCBVJywgZHVyYXRpb246ICczOjU0JyB9LFxuICAgIHsgdGl0bGU6ICdUaGUgQmVhdXRpZnVsIE9uZXMnLCBkdXJhdGlvbjogJzU6MTQnIH0sXG4gICAgeyB0aXRsZTogJ0NvbXB1dGVyIEJsdWUnLCBkdXJhdGlvbjogJzQ6MDAnIH0sXG4gICAgeyB0aXRsZTogJ0RhcmxpbmcgTmlra2knLCBkdXJhdGlvbjogJzQ6MTUnIH0sXG4gICAgeyB0aXRsZTogJ1doZW4gRG92ZXMgQ3J5JywgZHVyYXRpb246ICc1OjU0JyB9LFxuICAgIHsgdGl0bGU6ICdJIFdvdWxkIERpZSA0IFUnLCBkdXJhdGlvbjogJzI6NDknIH0sXG4gICAgeyB0aXRsZTogJ0JhYnkgSVxcJ20gQSBTdGFyJywgZHVyYXRpb246ICc0OjI1JyB9LFxuICAgIHsgdGl0bGU6ICdQdXJwbGUgUmFpbicsIGR1cmF0aW9uOiAnODo0MicgfVxuICBdXG59O1xuXG52YXIgcGxheUJ1dHRvblRlbXBsYXRlID0gJzxhIGNsYXNzPVwiYWxidW0tc29uZy1idXR0b25cIj48c3BhbiBjbGFzcz1cImlvbi1wbGF5XCI+PC9zcGFuPjwvYT4nO1xudmFyIHBhdXNlQnV0dG9uVGVtcGxhdGUgPSAnPGEgY2xhc3M9XCJhbGJ1bS1zb25nLWJ1dHRvblwiPjxzcGFuIGNsYXNzPVwiaW9uLXBhdXNlXCI+PC9zcGFuPjwvYT4nO1xudmFyIGN1cnJlbnRseVBsYXlpbmdTb25nID0gbnVsbDtcbnZhciBhbGJ1bUxpc3QgPSBbYWxidW1QaWNhc3NvLCBhbGJ1bU1hcmNvbmksIGFsYnVtUHVycGxlUmFpbl07XG52YXIgY291bnRlciA9IDA7XG5cbnZhciBjcmVhdGVTb25nUm93ID0gZnVuY3Rpb24oc29uZ051bWJlciwgc29uZ05hbWUsIHNvbmdMZW5ndGgpe1xuICB2YXIgdGVtcGxhdGUgPSBcbiAgICAgICc8dHIgY2xhc3M9XCJhbGJ1bS12aWV3LXNvbmctaXRlbVwiPicgKyBcbiAgICAgICcgIDx0ZCBjbGFzcz1cInNvbmctaXRlbS1udW1iZXJcIiBkYXRhLXNvbmctbnVtYmVyPVwiJyArIHNvbmdOdW1iZXIgKyAnXCI+JyArIHNvbmdOdW1iZXIgKyAnPC90ZD4nICsgXG4gICAgICAnICA8dGQgY2xhc3M9XCJzb25nLWl0ZW0tdGl0bGVcIj4nICsgc29uZ05hbWUgKyAnPC90ZD4nICsgXG4gICAgICAnICA8dGQgY2xhc3M9XCJzb25nLWl0ZW0tZHVyYXRpb25cIj4nICsgc29uZ0xlbmd0aCArICc8L3RkPicgKyBcbiAgICAgICc8L3RyPic7XG5cbiAgcmV0dXJuICQodGVtcGxhdGUpO1xufTtcblxudmFyIHNldEN1cnJlbnRBbGJ1bSA9IGZ1bmN0aW9uKGFsYnVtKSB7XG4gIC8vICMxXG4gIHZhciAkYWxidW1UaXRsZSA9ICQoJy5hbGJ1bS12aWV3LXRpdGxlJyk7XG4gIHZhciAkYWxidW1BcnRpc3QgPSAkKCcuYWxidW0tdmlldy1hcnRpc3QnKTtcbiAgdmFyICRhbGJ1bVJlbGVhc2VJbmZvID0gJCgnLmFsYnVtLXZpZXctcmVsZWFzZS1pbmZvJyk7XG4gIHZhciAkYWxidW1JbWFnZSA9ICQoJy5hbGJ1bS1jb3Zlci1hcnQnKTtcbiAgdmFyICRhbGJ1bVNvbmdMaXN0ID0gJCgnLmFsYnVtLXZpZXctc29uZy1saXN0Jyk7XG5cbiAgLy8gIzJcbiAgJGFsYnVtVGl0bGUudGV4dChhbGJ1bS50aXRsZSk7XG4gICRhbGJ1bUFydGlzdC50ZXh0KGFsYnVtLmFydGlzdCk7XG4gICRhbGJ1bVJlbGVhc2VJbmZvLnRleHQoYWxidW0ueWVhciArICcgJyArIGFsYnVtLmxhYmVsKTtcbiAgJGFsYnVtSW1hZ2UuYXR0cignc3JjJywgYWxidW0uYWxidW1BcnRVcmwpO1xuXG4gIC8vICMzXG4gICRhbGJ1bVNvbmdMaXN0LmVtcHR5KCk7XG5cbiAgLy8gIzRcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGJ1bS5zb25ncy5sZW5ndGg7IGkrKykge1xuICAgIHZhciAkbmV3Um93ID0gY3JlYXRlU29uZ1JvdyhpICsgMSwgYWxidW0uc29uZ3NbaV0udGl0bGUsIGFsYnVtLnNvbmdzW2ldLmR1cmF0aW9uKTtcbiAgICAkYWxidW1Tb25nTGlzdC5hcHBlbmQoJG5ld1Jvdyk7XG4gIH1cbn07XG5cbnZhciBmaW5kUGFyZW50QnlDbGFzc05hbWUgPSBmdW5jdGlvbihlbGVtZW50LCBwYXJlbnRDbGFzc05hbWUpe1xuICB2YXIgcGFyZW50RWxlbWVudDtcbiAgaWYoZWxlbWVudCl7XG4gICAgcGFyZW50RWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudCB8fCBudWxsO1xuICAgIGlmKHBhcmVudEVsZW1lbnQgPT09IG51bGwpeyBjb25zb2xlLmxvZyhcIk5vIHBhcmVudCBmb3VuZCBmb3IgXCIgKyBlbGVtZW50ICsgXCIuXCIpOyBcbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUocGFyZW50RWxlbWVudC5jbGFzc05hbWUgIT09IHBhcmVudENsYXNzTmFtZSAmJiBwYXJlbnRFbGVtZW50LmNsYXNzTmFtZSAhPT0gbnVsbCl7XG4gICAgICAgIHBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICB9XG4gICAgICBpZihwYXJlbnRFbGVtZW50LmNsYXNzTmFtZSAhPT0gcGFyZW50Q2xhc3NOYW1lKXsgY29uc29sZS5sb2coXCJObyBwYXJlbnQgZm91bmQgd2l0aCB0aGUgY2xhc3MgbmFtZSBcIiArIHBhcmVudENsYXNzTmFtZSArIFwiLlwiKTsgXG4gICAgICAgIHJldHVybiBwYXJlbnRFbGVtZW50O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJObyBcIiArIGVsZW1lbnQgKyBcIiBlbGVtZW50IGZvdW5kLlwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbnZhciBnZXRTb25nSXRlbSA9IGZ1bmN0aW9uKGVsZW1lbnQpe1xuICBzd2l0Y2ggKGVsZW1lbnQuY2xhc3NOYW1lKSB7XG4gICAgICBjYXNlICdhbGJ1bS1zb25nLWJ1dHRvbic6XG4gICAgICBjYXNlICdpb24tcGxheSc6XG4gICAgICBjYXNlICdpb24tcGF1c2UnOlxuICAgICAgICAgIHJldHVybiBmaW5kUGFyZW50QnlDbGFzc05hbWUoZWxlbWVudCwgJ3NvbmctaXRlbS1udW1iZXInKTtcbiAgICAgIGNhc2UgJ2FsYnVtLXZpZXctc29uZy1pdGVtJzpcbiAgICAgICAgICByZXR1cm4gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuc29uZy1pdGVtLW51bWJlcicpO1xuICAgICAgY2FzZSAnc29uZy1pdGVtLXRpdGxlJzpcbiAgICAgIGNhc2UgJ3NvbmctaXRlbS1kdXJhdGlvbic6XG4gICAgICAgICAgcmV0dXJuIGZpbmRQYXJlbnRCeUNsYXNzTmFtZShlbGVtZW50LCAnYWxidW0tdmlldy1zb25nLWl0ZW0nKS5xdWVyeVNlbGVjdG9yKCcuc29uZy1pdGVtLW51bWJlcicpO1xuICAgICAgY2FzZSAnc29uZy1pdGVtLW51bWJlcic6XG4gICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybjtcbiAgfSAgXG59O1xuXG52YXIgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24odGFyZ2V0RWxlbWVudCkge1xuICB2YXIgc29uZ0l0ZW0gPSBnZXRTb25nSXRlbSh0YXJnZXRFbGVtZW50KTtcbiAgaWYgKGN1cnJlbnRseVBsYXlpbmdTb25nID09PSBudWxsKSB7XG4gICAgc29uZ0l0ZW0uaW5uZXJIVE1MID0gcGF1c2VCdXR0b25UZW1wbGF0ZTtcbiAgICBjdXJyZW50bHlQbGF5aW5nU29uZyA9IHNvbmdJdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1zb25nLW51bWJlcicpO1xuICB9IFxuICBlbHNlIGlmIChjdXJyZW50bHlQbGF5aW5nU29uZyA9PT0gc29uZ0l0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXNvbmctbnVtYmVyJykpIHtcbiAgICBzb25nSXRlbS5pbm5lckhUTUwgPSBwbGF5QnV0dG9uVGVtcGxhdGU7XG4gICAgY3VycmVudGx5UGxheWluZ1NvbmcgPSBudWxsO1xuICB9XG4gIGVsc2UgaWYgKGN1cnJlbnRseVBsYXlpbmdTb25nICE9PSBzb25nSXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc29uZy1udW1iZXInKSkge1xuICAgIHZhciBjdXJyZW50bHlQbGF5aW5nU29uZ0VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zb25nLW51bWJlcj1cIicgKyBjdXJyZW50bHlQbGF5aW5nU29uZyArICdcIl0nKTtcbiAgICBjdXJyZW50bHlQbGF5aW5nU29uZ0VsZW1lbnQuaW5uZXJIVE1MID0gY3VycmVudGx5UGxheWluZ1NvbmdFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zb25nLW51bWJlcicpO1xuICAgIHNvbmdJdGVtLmlubmVySFRNTCA9IHBhdXNlQnV0dG9uVGVtcGxhdGU7XG4gICAgY3VycmVudGx5UGxheWluZ1NvbmcgPSBzb25nSXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc29uZy1udW1iZXInKTtcbiAgfVxufTtcblxud2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICBzZXRDdXJyZW50QWxidW0oYWxidW1QaWNhc3NvKTtcbiAgYWxidW1Db3ZlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbGJ1bS1jb3ZlcicpO1xuICBzb25nTGlzdENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2FsYnVtLXZpZXctc29uZy1saXN0JylbMF07XG4gIHNvbmdSb3dzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYWxidW0tdmlldy1zb25nLWl0ZW0nKTtcblxuICBhbGJ1bUNvdmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCl7ICAgXG4gICAgLy9jb25zb2xlLmxvZyhldmVudCk7XG4gICAgc2V0Q3VycmVudEFsYnVtKGFsYnVtTGlzdFtjb3VudGVyXSk7XG4gICAgY291bnRlcisrO1xuICAgIGlmKGNvdW50ZXIgPj0gYWxidW1MaXN0Lmxlbmd0aCl7IGNvdW50ZXIgPSAwOyB9XG4gIH0sIGZhbHNlKTtcblxuICBzb25nTGlzdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBmdW5jdGlvbihldmVudCl7XG4gICAgLy9jb25zb2xlLmxvZyhldmVudC50YXJnZXQpO1xuICAgIGlmKGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZSA9PT0gJ2FsYnVtLXZpZXctc29uZy1pdGVtJyl7XG4gICAgICBldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuc29uZy1pdGVtLW51bWJlcicpLmlubmVySFRNTCA9IHBsYXlCdXR0b25UZW1wbGF0ZTtcbiAgICAgIHZhciBzb25nSXRlbSA9IGdldFNvbmdJdGVtKGV2ZW50LnRhcmdldCk7XG4gICAgICBpZiAoc29uZ0l0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXNvbmctbnVtYmVyJykgIT09IGN1cnJlbnRseVBsYXlpbmdTb25nKSB7XG4gICAgICAgIHNvbmdJdGVtLmlubmVySFRNTCA9IHBsYXlCdXR0b25UZW1wbGF0ZTtcbiAgICAgIH0gICAgICBcbiAgICB9XG4gIH0pO1xuXG4gIGZvcih2YXIgaSA9IDA7IGkgPCBzb25nUm93cy5sZW5ndGg7IGkrKyl7XG4gICAgc29uZ1Jvd3NbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgIHZhciBzb25nSXRlbSA9IGdldFNvbmdJdGVtKGV2ZW50LnRhcmdldCk7XG4gICAgICB2YXIgc29uZ0l0ZW1OdW1iZXIgPSBzb25nSXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc29uZy1udW1iZXInKTtcblxuICAgICAgaWYgKHNvbmdJdGVtTnVtYmVyICE9PSBjdXJyZW50bHlQbGF5aW5nU29uZykge1xuICAgICAgICAgc29uZ0l0ZW0uaW5uZXJIVE1MID0gc29uZ0l0ZW1OdW1iZXI7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzb25nUm93c1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjbGlja0hhbmRsZXIoZXZlbnQudGFyZ2V0KTtcbiAgICB9KTsgICAgXG4gIH1cbn07Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
