var currentAlbum=null,currentlyPlayingSongNumber=null,currentSongFromAlbum=null,currentSongFile=null,$previousButton=$(".main-controls .previous"),$nextButton=$(".main-controls .next"),albumList=[albumPicasso,albumMarconi,albumPurpleRain],counter=0,playButtonTemplate="<a class='album-song-button'><span class='ion-play'></span></a>",pauseButtonTemplate="<a class='album-song-button'><span class='ion-pause'></span></a>",playerBarPlayButton="<span class='ion-play'></span>",playerBarPauseButton="<span class='ion-pause'></span>",createSongRow=function(n,t,e){var r="<tr class='album-view-song-item'>  <td class='song-item-number' data-song-number='"+n+"'>"+n+"</td>  <td class='song-item-title'>"+t+"</td>  <td class='song-item-duration'>"+e+"</td></tr>",u=$(r),a=function(){var n=$(this).attr("data-song-number");if(null!==currentlyPlayingSongNumber){var t=getSongNumberContainer(currentlyPlayingSongNumber);t.html(currentlyPlayingSongNumber)}currentlyPlayingSongNumber!==n?($(this).html(pauseButtonTemplate),setSong(n),updatePlayerBarSong(),currentSongFile.play()):currentlyPlayingSongNumber===n&&(currentSongFile.isPaused()?($(this).html(pauseButtonTemplate),$(".main-controls .play-pause").html(playerBarPauseButton),currentSongFile.play()):($(this).html(playButtonTemplate),$(".main-controls .play-pause").html(playerBarPlayButton),currentSongFile.pause()))},l=function(n){var t=$(this).find(".song-item-number"),e=t.attr("data-song-number");e!==currentlyPlayingSongNumber&&t.html(playButtonTemplate)},o=function(n){var t=$(this).find(".song-item-number"),e=t.attr("data-song-number");e!==currentlyPlayingSongNumber&&t.html(e)};return u.find(".song-item-number").click(a),u.hover(l,o),u},setCurrentAlbum=function(n){currentAlbum=n;var t=$(".album-view-title"),e=$(".album-view-artist"),r=$(".album-view-release-info"),u=$(".album-cover-art"),a=$(".album-view-song-list");t.text(n.title),e.text(n.artist),r.text(n.year+" "+n.label),u.attr("src",n.albumArtUrl),a.empty();for(var l=0;l<n.songs.length;l++){var o=createSongRow(l+1,n.songs[l].title,n.songs[l].duration);a.append(o)}},updatePlayerBarSong=function(){$(".main-controls .play-pause").html(playerBarPauseButton)},trackIndex=function(n,t){return n.songs.indexOf(t)},nextSong=function(){var n=function(n){return 0===n?currentAlbum.songs.length:n},t=trackIndex(currentAlbum,currentSongFromAlbum);t++,t>=currentAlbum.songs.length&&(t=0),setSong(t+1),currentSongFile.play(),updatePlayerBarSong();var e=n(t),r=getSongNumberContainer(currentlyPlayingSongNumber),u=getSongNumberContainer(e);r.html(pauseButtonTemplate),u.html(e)},previousSong=function(){var n=function(n){return n==currentAlbum.songs.length-1?1:n+2},t=trackIndex(currentAlbum,currentSongFromAlbum);t--,t<0&&(t=currentAlbum.songs.length-1),setSong(t+1),currentSongFile.play(),updatePlayerBarSong();var e=n(t),r=getSongNumberContainer(currentlyPlayingSongNumber),u=getSongNumberContainer(e);r.html(pauseButtonTemplate),u.html(e)},setSong=function(n){currentSongFile&&currentSongFile.stop(),currentlyPlayingSongNumber=n,currentSongFromAlbum=currentAlbum.songs[n-1],currentSongFile=new buzz.sound(currentSongFromAlbum.audioUrl,{formats:["mp3"],preload:!0}),$(".currently-playing .song-name").text(currentSongFromAlbum.title),$(".currently-playing .artist-name").text(currentSongFromAlbum.artist),$(".currently-playing .artist-song-mobile").text(currentSongFromAlbum.title+" - "+currentAlbum.title),$(".main-controls .play-pause").html(playerBarPauseButton)},getSongNumberContainer=function(n){return $(".song-item-number[data-song-number='"+n+"']")};$(document).ready(function(){setCurrentAlbum(albumPicasso),$previousButton.click(previousSong),$nextButton.click(nextSong);document.getElementById("album-cover")});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsYnVtLmpzIl0sIm5hbWVzIjpbImN1cnJlbnRBbGJ1bSIsImN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyIiwiY3VycmVudFNvbmdGcm9tQWxidW0iLCJjdXJyZW50U29uZ0ZpbGUiLCIkcHJldmlvdXNCdXR0b24iLCIkIiwiJG5leHRCdXR0b24iLCJhbGJ1bUxpc3QiLCJhbGJ1bVBpY2Fzc28iLCJhbGJ1bU1hcmNvbmkiLCJhbGJ1bVB1cnBsZVJhaW4iLCJjb3VudGVyIiwicGxheUJ1dHRvblRlbXBsYXRlIiwicGF1c2VCdXR0b25UZW1wbGF0ZSIsInBsYXllckJhclBsYXlCdXR0b24iLCJwbGF5ZXJCYXJQYXVzZUJ1dHRvbiIsImNyZWF0ZVNvbmdSb3ciLCJzb25nTnVtYmVyIiwic29uZ05hbWUiLCJzb25nTGVuZ3RoIiwidGVtcGxhdGUiLCIkcm93IiwiY2xpY2tIYW5kbGVyIiwidGhpcyIsImF0dHIiLCJjdXJyZW50bHlQbGF5aW5nQ29udGFpbmVyIiwiZ2V0U29uZ051bWJlckNvbnRhaW5lciIsImh0bWwiLCJzZXRTb25nIiwidXBkYXRlUGxheWVyQmFyU29uZyIsInBsYXkiLCJpc1BhdXNlZCIsInBhdXNlIiwib25Ib3ZlciIsImV2ZW50Iiwic29uZ051bWJlckNvbnRhaW5lciIsImZpbmQiLCJvZmZIb3ZlciIsImNsaWNrIiwiaG92ZXIiLCJzZXRDdXJyZW50QWxidW0iLCJhbGJ1bSIsIiRhbGJ1bVRpdGxlIiwiJGFsYnVtQXJ0aXN0IiwiJGFsYnVtUmVsZWFzZUluZm8iLCIkYWxidW1JbWFnZSIsIiRhbGJ1bVNvbmdMaXN0IiwidGV4dCIsInRpdGxlIiwiYXJ0aXN0IiwieWVhciIsImxhYmVsIiwiYWxidW1BcnRVcmwiLCJlbXB0eSIsImkiLCJzb25ncyIsImxlbmd0aCIsIiRuZXdSb3ciLCJkdXJhdGlvbiIsImFwcGVuZCIsInRyYWNrSW5kZXgiLCJzb25nIiwiaW5kZXhPZiIsIm5leHRTb25nIiwiZ2V0TGFzdFNvbmdOdW1iZXIiLCJpbmRleCIsImN1cnJlbnRTb25nSW5kZXgiLCJsYXN0U29uZ051bWJlciIsIiRuZXh0U29uZ051bWJlckNlbGwiLCIkbGFzdFNvbmdOdW1iZXJDZWxsIiwicHJldmlvdXNTb25nIiwiJHByZXZpb3VzU29uZ051bWJlckNlbGwiLCJzdG9wIiwiYnV6eiIsInNvdW5kIiwiYXVkaW9VcmwiLCJmb3JtYXRzIiwicHJlbG9hZCIsIm51bWJlciIsImRvY3VtZW50IiwicmVhZHkiLCJnZXRFbGVtZW50QnlJZCJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBSUEsY0FBZSxLQUNmQywyQkFBNkIsS0FDN0JDLHFCQUF1QixLQUN2QkMsZ0JBQWtCLEtBRWxCQyxnQkFBa0JDLEVBQUUsNEJBQ3BCQyxZQUFjRCxFQUFFLHdCQUVoQkUsV0FBYUMsYUFBY0MsYUFBY0MsaUJBQ3pDQyxRQUFVLEVBQ1ZDLG1CQUFxQixrRUFDckJDLG9CQUFzQixtRUFDdEJDLG9CQUFzQixpQ0FDdEJDLHFCQUF1QixrQ0FHdkJDLGNBQWdCLFNBQVNDLEVBQVlDLEVBQVVDLEdBQ2pELEdBQUlDLEdBQ0EscUZBQ3NESCxFQUFhLEtBQU9BLEVBQWEsc0NBQ3BEQyxFQUFXLHlDQUNSQyxFQUFhLGFBR25ERSxFQUFPaEIsRUFBRWUsR0FFVEUsRUFBZSxXQUNqQixHQUFJTCxHQUFhWixFQUFFa0IsTUFBTUMsS0FBSyxtQkFFOUIsSUFBa0MsT0FBL0J2QiwyQkFBb0MsQ0FDckMsR0FBSXdCLEdBQTRCQyx1QkFBdUJ6QiwyQkFDdkR3QixHQUEwQkUsS0FBSzFCLDRCQUU5QkEsNkJBQStCZ0IsR0FDaENaLEVBQUVrQixNQUFNSSxLQUFLZCxxQkFDYmUsUUFBUVgsR0FDUlksc0JBQ0ExQixnQkFBZ0IyQixRQUNQN0IsNkJBQStCZ0IsSUFDckNkLGdCQUFnQjRCLFlBQ2pCMUIsRUFBRWtCLE1BQU1JLEtBQUtkLHFCQUNiUixFQUFFLDhCQUE4QnNCLEtBQUtaLHNCQUNyQ1osZ0JBQWdCMkIsU0FFaEJ6QixFQUFFa0IsTUFBTUksS0FBS2Ysb0JBQ2JQLEVBQUUsOEJBQThC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N0MscUJBQXFCOEMsTUFBUSxNQUFRaEQsYUFBYWdELE9BRW5HM0MsRUFBRSw4QkFBOEJzQixLQUFLWix1QkFHbkNXLHVCQUF5QixTQUFTb0QsR0FDcEMsTUFBT3pFLEdBQUUsdUNBQXlDeUUsRUFBUyxNQUc3RHpFLEdBQUUwRSxVQUFVQyxNQUFNLFdBQ2hCeEMsZ0JBQWdCaEMsY0FDaEJKLGdCQUFnQmtDLE1BQU1nQyxjQUN0QmhFLFlBQVlnQyxNQUFNeUIsU0FDRGdCLFVBQVNFLGVBQWUiLCJmaWxlIjoiYWxidW0uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmdsb2JhbCAkIGFsYnVtUGljYXNzbyBhbGJ1bU1hcmNvbmkgYWxidW1QdXJwbGVSYWluIDp0cnVlKi9cblxudmFyIGN1cnJlbnRBbGJ1bSA9IG51bGw7XG52YXIgY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIgPSBudWxsO1xudmFyIGN1cnJlbnRTb25nRnJvbUFsYnVtID0gbnVsbDtcbnZhciBjdXJyZW50U29uZ0ZpbGUgPSBudWxsO1xuXG52YXIgJHByZXZpb3VzQnV0dG9uID0gJChcIi5tYWluLWNvbnRyb2xzIC5wcmV2aW91c1wiKTtcbnZhciAkbmV4dEJ1dHRvbiA9ICQoXCIubWFpbi1jb250cm9scyAubmV4dFwiKTtcblxudmFyIGFsYnVtTGlzdCA9IFthbGJ1bVBpY2Fzc28sIGFsYnVtTWFyY29uaSwgYWxidW1QdXJwbGVSYWluXTtcbnZhciBjb3VudGVyID0gMDtcbnZhciBwbGF5QnV0dG9uVGVtcGxhdGUgPSBcIjxhIGNsYXNzPSdhbGJ1bS1zb25nLWJ1dHRvbic+PHNwYW4gY2xhc3M9J2lvbi1wbGF5Jz48L3NwYW4+PC9hPlwiO1xudmFyIHBhdXNlQnV0dG9uVGVtcGxhdGUgPSBcIjxhIGNsYXNzPSdhbGJ1bS1zb25nLWJ1dHRvbic+PHNwYW4gY2xhc3M9J2lvbi1wYXVzZSc+PC9zcGFuPjwvYT5cIjtcbnZhciBwbGF5ZXJCYXJQbGF5QnV0dG9uID0gXCI8c3BhbiBjbGFzcz0naW9uLXBsYXknPjwvc3Bhbj5cIjtcbnZhciBwbGF5ZXJCYXJQYXVzZUJ1dHRvbiA9IFwiPHNwYW4gY2xhc3M9J2lvbi1wYXVzZSc+PC9zcGFuPlwiO1xuXG5cbnZhciBjcmVhdGVTb25nUm93ID0gZnVuY3Rpb24oc29uZ051bWJlciwgc29uZ05hbWUsIHNvbmdMZW5ndGgpe1xuICB2YXIgdGVtcGxhdGUgPSBcbiAgICAgIFwiPHRyIGNsYXNzPSdhbGJ1bS12aWV3LXNvbmctaXRlbSc+XCIgKyBcbiAgICAgIFwiICA8dGQgY2xhc3M9J3NvbmctaXRlbS1udW1iZXInIGRhdGEtc29uZy1udW1iZXI9J1wiICsgc29uZ051bWJlciArIFwiJz5cIiArIHNvbmdOdW1iZXIgKyBcIjwvdGQ+XCIgKyBcbiAgICAgIFwiICA8dGQgY2xhc3M9J3NvbmctaXRlbS10aXRsZSc+XCIgKyBzb25nTmFtZSArIFwiPC90ZD5cIiArIFxuICAgICAgXCIgIDx0ZCBjbGFzcz0nc29uZy1pdGVtLWR1cmF0aW9uJz5cIiArIHNvbmdMZW5ndGggKyBcIjwvdGQ+XCIgKyBcbiAgICAgIFwiPC90cj5cIjtcblxuICB2YXIgJHJvdyA9ICQodGVtcGxhdGUpO1xuXG4gIHZhciBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbigpe1xuICAgIHZhciBzb25nTnVtYmVyID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1zb25nLW51bWJlclwiKTtcblxuICAgIGlmKGN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyICE9PSBudWxsKXtcbiAgICAgIHZhciBjdXJyZW50bHlQbGF5aW5nQ29udGFpbmVyID0gZ2V0U29uZ051bWJlckNvbnRhaW5lcihjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlcik7XG4gICAgICBjdXJyZW50bHlQbGF5aW5nQ29udGFpbmVyLmh0bWwoY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIpO1xuICAgIH1cbiAgICBpZihjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlciAhPT0gc29uZ051bWJlcil7XG4gICAgICAkKHRoaXMpLmh0bWwocGF1c2VCdXR0b25UZW1wbGF0ZSk7XG4gICAgICBzZXRTb25nKHNvbmdOdW1iZXIpO1xuICAgICAgdXBkYXRlUGxheWVyQmFyU29uZygpO1xuICAgICAgY3VycmVudFNvbmdGaWxlLnBsYXkoKTtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyID09PSBzb25nTnVtYmVyKXtcbiAgICAgIGlmKGN1cnJlbnRTb25nRmlsZS5pc1BhdXNlZCgpKXtcbiAgICAgICAgJCh0aGlzKS5odG1sKHBhdXNlQnV0dG9uVGVtcGxhdGUpO1xuICAgICAgICAkKFwiLm1haW4tY29udHJvbHMgLnBsYXktcGF1c2VcIikuaHRtbChwbGF5ZXJCYXJQYXVzZUJ1dHRvbik7XG4gICAgICAgIGN1cnJlbnRTb25nRmlsZS5wbGF5KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKHRoaXMpLmh0bWwocGxheUJ1dHRvblRlbXBsYXRlKTtcbiAgICAgICAgJChcIi5tYWluLWNvbnRyb2xzIC5wbGF5LXBhdXNlXCIpLmh0bWwocGxheWVyQmFyUGxheUJ1dHRvbik7XG4gICAgICAgIGN1cnJlbnRTb25nRmlsZS5wYXVzZSgpOyAgICAgICAgXG4gICAgICB9XG4gICAgfVxuXG4gIH07XG5cbiAgdmFyIG9uSG92ZXIgPSBmdW5jdGlvbihldmVudCl7XG4gICAgdmFyIHNvbmdOdW1iZXJDb250YWluZXIgPSAkKHRoaXMpLmZpbmQoXCIuc29uZy1pdGVtLW51bWJlclwiKTtcbiAgICB2YXIgc29uZ051bWJlciA9IHNvbmdOdW1iZXJDb250YWluZXIuYXR0cihcImRhdGEtc29uZy1udW1iZXJcIik7XG5cbiAgICBpZihzb25nTnVtYmVyICE9PSBjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlcil7XG4gICAgICBzb25nTnVtYmVyQ29udGFpbmVyLmh0bWwocGxheUJ1dHRvblRlbXBsYXRlKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9mZkhvdmVyID0gZnVuY3Rpb24oZXZlbnQpe1xuICAgIHZhciBzb25nTnVtYmVyQ29udGFpbmVyID0gJCh0aGlzKS5maW5kKFwiLnNvbmctaXRlbS1udW1iZXJcIik7XG4gICAgdmFyIHNvbmdOdW1iZXIgPSBzb25nTnVtYmVyQ29udGFpbmVyLmF0dHIoXCJkYXRhLXNvbmctbnVtYmVyXCIpO1xuXG4gICAgaWYoc29uZ051bWJlciAhPT0gY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIpe1xuICAgICAgc29uZ051bWJlckNvbnRhaW5lci5odG1sKHNvbmdOdW1iZXIpO1xuICAgIH1cbiAgfTtcblxuICAkcm93LmZpbmQoXCIuc29uZy1pdGVtLW51bWJlclwiKS5jbGljayhjbGlja0hhbmRsZXIpO1xuICAkcm93LmhvdmVyKG9uSG92ZXIsIG9mZkhvdmVyKTtcbiAgcmV0dXJuICRyb3c7XG59O1xuXG52YXIgc2V0Q3VycmVudEFsYnVtID0gZnVuY3Rpb24oYWxidW0pIHtcbiAgY3VycmVudEFsYnVtID0gYWxidW07XG5cbiAgdmFyICRhbGJ1bVRpdGxlID0gJChcIi5hbGJ1bS12aWV3LXRpdGxlXCIpO1xuICB2YXIgJGFsYnVtQXJ0aXN0ID0gJChcIi5hbGJ1bS12aWV3LWFydGlzdFwiKTtcbiAgdmFyICRhbGJ1bVJlbGVhc2VJbmZvID0gJChcIi5hbGJ1bS12aWV3LXJlbGVhc2UtaW5mb1wiKTtcbiAgdmFyICRhbGJ1bUltYWdlID0gJChcIi5hbGJ1bS1jb3Zlci1hcnRcIik7XG4gIHZhciAkYWxidW1Tb25nTGlzdCA9ICQoXCIuYWxidW0tdmlldy1zb25nLWxpc3RcIik7XG5cbiAgJGFsYnVtVGl0bGUudGV4dChhbGJ1bS50aXRsZSk7XG4gICRhbGJ1bUFydGlzdC50ZXh0KGFsYnVtLmFydGlzdCk7XG4gICRhbGJ1bVJlbGVhc2VJbmZvLnRleHQoYWxidW0ueWVhciArIFwiIFwiICsgYWxidW0ubGFiZWwpO1xuICAkYWxidW1JbWFnZS5hdHRyKFwic3JjXCIsIGFsYnVtLmFsYnVtQXJ0VXJsKTtcblxuICAkYWxidW1Tb25nTGlzdC5lbXB0eSgpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYWxidW0uc29uZ3MubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgJG5ld1JvdyA9IGNyZWF0ZVNvbmdSb3coaSArIDEsIGFsYnVtLnNvbmdzW2ldLnRpdGxlLCBhbGJ1bS5zb25nc1tpXS5kdXJhdGlvbik7XG4gICAgJGFsYnVtU29uZ0xpc3QuYXBwZW5kKCRuZXdSb3cpO1xuICB9XG59O1xuXG52YXIgdXBkYXRlUGxheWVyQmFyU29uZyA9IGZ1bmN0aW9uKCl7XG4gICQoXCIubWFpbi1jb250cm9scyAucGxheS1wYXVzZVwiKS5odG1sKHBsYXllckJhclBhdXNlQnV0dG9uKTtcbn07XG5cbnZhciB0cmFja0luZGV4ID0gZnVuY3Rpb24oYWxidW0sIHNvbmcpe1xuICByZXR1cm4gYWxidW0uc29uZ3MuaW5kZXhPZihzb25nKTtcbn07XG5cbnZhciBuZXh0U29uZyA9IGZ1bmN0aW9uKCl7XG4gIHZhciBnZXRMYXN0U29uZ051bWJlciA9IGZ1bmN0aW9uKGluZGV4KXtcbiAgICByZXR1cm4gaW5kZXggPT09IDAgPyBjdXJyZW50QWxidW0uc29uZ3MubGVuZ3RoIDogaW5kZXg7XG4gIH07XG5cbiAgdmFyIGN1cnJlbnRTb25nSW5kZXggPSB0cmFja0luZGV4KGN1cnJlbnRBbGJ1bSwgY3VycmVudFNvbmdGcm9tQWxidW0pO1xuICBjdXJyZW50U29uZ0luZGV4Kys7XG5cbiAgaWYoY3VycmVudFNvbmdJbmRleCA+PSBjdXJyZW50QWxidW0uc29uZ3MubGVuZ3RoKXtcbiAgICBjdXJyZW50U29uZ0luZGV4ID0gMDtcbiAgfVxuXG4gIHNldFNvbmcoY3VycmVudFNvbmdJbmRleCArIDEpO1xuICBjdXJyZW50U29uZ0ZpbGUucGxheSgpO1xuICB1cGRhdGVQbGF5ZXJCYXJTb25nKCk7XG5cbiAgdmFyIGxhc3RTb25nTnVtYmVyID0gZ2V0TGFzdFNvbmdOdW1iZXIoY3VycmVudFNvbmdJbmRleCk7XG4gIHZhciAkbmV4dFNvbmdOdW1iZXJDZWxsID0gZ2V0U29uZ051bWJlckNvbnRhaW5lcihjdXJyZW50bHlQbGF5aW5nU29uZ051bWJlcik7XG4gIHZhciAkbGFzdFNvbmdOdW1iZXJDZWxsID0gZ2V0U29uZ051bWJlckNvbnRhaW5lcihsYXN0U29uZ051bWJlcik7XG5cbiAgJG5leHRTb25nTnVtYmVyQ2VsbC5odG1sKHBhdXNlQnV0dG9uVGVtcGxhdGUpO1xuICAkbGFzdFNvbmdOdW1iZXJDZWxsLmh0bWwobGFzdFNvbmdOdW1iZXIpO1xufTtcblxudmFyIHByZXZpb3VzU29uZyA9IGZ1bmN0aW9uKCl7XG4gIHZhciBnZXRMYXN0U29uZ051bWJlciA9IGZ1bmN0aW9uKGluZGV4KXtcbiAgICByZXR1cm4gaW5kZXggPT0gKGN1cnJlbnRBbGJ1bS5zb25ncy5sZW5ndGggLSAxKSA/IDEgOiBpbmRleCArIDI7XG4gIH07XG5cbiAgdmFyIGN1cnJlbnRTb25nSW5kZXggPSB0cmFja0luZGV4KGN1cnJlbnRBbGJ1bSwgY3VycmVudFNvbmdGcm9tQWxidW0pO1xuICBjdXJyZW50U29uZ0luZGV4LS07XG5cbiAgaWYoY3VycmVudFNvbmdJbmRleCA8IDApIHtcbiAgICBjdXJyZW50U29uZ0luZGV4ID0gY3VycmVudEFsYnVtLnNvbmdzLmxlbmd0aCAtIDE7XG4gIH1cblxuICBzZXRTb25nKGN1cnJlbnRTb25nSW5kZXggKyAxKTtcbiAgY3VycmVudFNvbmdGaWxlLnBsYXkoKTtcbiAgdXBkYXRlUGxheWVyQmFyU29uZygpO1xuXG4gIHZhciBsYXN0U29uZ051bWJlciA9IGdldExhc3RTb25nTnVtYmVyKGN1cnJlbnRTb25nSW5kZXgpO1xuICB2YXIgJHByZXZpb3VzU29uZ051bWJlckNlbGwgPSBnZXRTb25nTnVtYmVyQ29udGFpbmVyKGN1cnJlbnRseVBsYXlpbmdTb25nTnVtYmVyKTtcbiAgdmFyICRsYXN0U29uZ051bWJlckNlbGwgPSBnZXRTb25nTnVtYmVyQ29udGFpbmVyKGxhc3RTb25nTnVtYmVyKTtcblxuICAkcHJldmlvdXNTb25nTnVtYmVyQ2VsbC5odG1sKHBhdXNlQnV0dG9uVGVtcGxhdGUpO1xuICAkbGFzdFNvbmdOdW1iZXJDZWxsLmh0bWwobGFzdFNvbmdOdW1iZXIpOyAgXG59O1xuXG52YXIgc2V0U29uZyA9IGZ1bmN0aW9uKHNvbmdOdW1iZXIpe1xuICBpZihjdXJyZW50U29uZ0ZpbGUpe1xuICAgIGN1cnJlbnRTb25nRmlsZS5zdG9wKCk7XG4gIH1cbiAgY3VycmVudGx5UGxheWluZ1NvbmdOdW1iZXIgPSBzb25nTnVtYmVyO1xuICBjdXJyZW50U29uZ0Zyb21BbGJ1bSA9IGN1cnJlbnRBbGJ1bS5zb25nc1tzb25nTnVtYmVyIC0gMV07XG5cbiAgY3VycmVudFNvbmdGaWxlID0gbmV3IGJ1enouc291bmQoY3VycmVudFNvbmdGcm9tQWxidW0uYXVkaW9VcmwsIHtcbiAgICBmb3JtYXRzOiBbJ21wMyddLFxuICAgIHByZWxvYWQ6IHRydWVcbiAgfSk7XG5cbiAgJChcIi5jdXJyZW50bHktcGxheWluZyAuc29uZy1uYW1lXCIpLnRleHQoY3VycmVudFNvbmdGcm9tQWxidW0udGl0bGUpO1xuICAkKFwiLmN1cnJlbnRseS1wbGF5aW5nIC5hcnRpc3QtbmFtZVwiKS50ZXh0KGN1cnJlbnRTb25nRnJvbUFsYnVtLmFydGlzdCk7XG4gICQoXCIuY3VycmVudGx5LXBsYXlpbmcgLmFydGlzdC1zb25nLW1vYmlsZVwiKS50ZXh0KGN1cnJlbnRTb25nRnJvbUFsYnVtLnRpdGxlICsgXCIgLSBcIiArIGN1cnJlbnRBbGJ1bS50aXRsZSk7XG5cbiAgJChcIi5tYWluLWNvbnRyb2xzIC5wbGF5LXBhdXNlXCIpLmh0bWwocGxheWVyQmFyUGF1c2VCdXR0b24pO1xufTtcblxudmFyIGdldFNvbmdOdW1iZXJDb250YWluZXIgPSBmdW5jdGlvbihudW1iZXIpe1xuICByZXR1cm4gJChcIi5zb25nLWl0ZW0tbnVtYmVyW2RhdGEtc29uZy1udW1iZXI9J1wiICsgbnVtYmVyICsgXCInXVwiKTtcbn07XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkgeyBcbiAgc2V0Q3VycmVudEFsYnVtKGFsYnVtUGljYXNzbyk7XG4gICRwcmV2aW91c0J1dHRvbi5jbGljayhwcmV2aW91c1NvbmcpO1xuICAkbmV4dEJ1dHRvbi5jbGljayhuZXh0U29uZyk7XG4gIHZhciBhbGJ1bUNvdmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbGJ1bS1jb3ZlclwiKTsgXG59KTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
